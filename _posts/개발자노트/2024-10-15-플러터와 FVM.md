---
layout: post
title: "개발자노트: FVM으로 플러터 버전 관리하기"
author: "Jin"
tags: 개발자노트
---

## FVM이 왜 필요할까

Flutter로 개발을 하다 보면 서로 다른 버전으로 프로젝트를 진행해야 하는 경우가 생긴다.

나의 경우, 당시 서비스하던 프로덕트는 **3.22 버전**으로 빌드되었고, 메이저 업데이트와 함께 **3.24 버전**으로 업그레이드할 계획이었다. 그 이유는 안드로이드에서의 렌더링 성능이 부족했기 때문에 **Impeller**를 적용하려고 했기 때문이다. (물론 최적화를 하는 것이 최우선 과제지만!)

3.24 버전을 기반으로 **메이저 업데이트**를 진행하는 도중, 현재 서비스 버전에서 이슈가 발생해 **마이너 업데이트 버전**을 긴급 배포해야 했다. 하지만 3.24 버전에서 여전히 **Impeller 이슈**가 보고되고 있었기 때문에 충분한 검증 없이 해당 버전으로 배포할 수는 없었다. 메이저 업데이트에서는 이 이슈를 발견할 시간이 충분하지만, 마이너 업데이트의 경우 이슈를 놓칠 수 있기 때문에 3.22 버전으로 배포할 필요가 있었다.

처음에는 수동으로 3.22로 버전을 낮춘 후 수정 버전을 배포하고, 다시 3.24로 변경하는 방식으로 해결했다. 하지만 이러한 과정이 몇 번 반복되다 보니, 환경 세팅에 너무 많은 시간이 소요되었다. 이러한 비효율을 방지하기 위해 **FVM**(Flutter Version Management)을 적용하기로 했다.

## FVM 적용하기

터미널에서 다음 명령어를 사용해 FVM을 활성화한다.


```bash
dart pub global activate fvm
```

`.bashrc` 혹은 `.zshrc`에  `$HOME/.pub-cache/bin` 경로를 **PATH**에 추가해준다.

FVM을 통해 Flutter 버전을 설치하려면 다음 명령어를 사용한다.

```bash
fvm install [원하는버전]

or

fvm install stable # 최신의 안정적인 버전
```

설치된 버전들은 다음 명령어로 확인할 수 있다.

```bash
fvm install list
```

이제 프로젝트 또는 전역적으로 특정 버전을 사용하려면 다음 명령어를 사용한다.

```bash
fvm global [원하는버전] # 전역적으로 사용할 버전

fvm use [원하는버전] # 해당 프로젝트에서 사용할 버전
```

## FVM을 적용한 개발 환경 설정

### 안드로이드 스튜디오에서 FVM 적용


안드로이드 스튜디오에서 플러터 sdk 경로를 변경해줘야 한다.

`settings > Languages & Frameworks > Flutter` 로 이동한 후, **Flutter SDK Path**를 다음 경로로 지정한다.

```bash
[프로젝트 경로]/.fvm/flutter_sdk
```

### Xcode에서 FVM 적용

iOS 빌드를 위해서는 Xcode에서 추가 설정이 필요하다.

Xcode에서 Runner 프로젝트의 `Build Phases > Run Script` 섹션으로 이동하여, 다음 스크립트를 가장 앞에 추가한다.

```bash
export FLUTTER_ROOT="[프로젝트 경로]/.fvm/flutter_sdk"
```

이 설정을 적용하면 Xcode에서 아카이브를 생성할 때 선택한 Flutter 버전이 적용된다.